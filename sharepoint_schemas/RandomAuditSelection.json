{
  "$schema": "https://developer.microsoft.com/json-schemas/sp/list-formatting.schema.json",
  "listName": "RandomAuditSelection",
  "description": "Weekly random selection batches for trolley audits",
  "baseTemplate": "genericList",
  "columns": [
    {
      "internalName": "Title",
      "displayName": "Selection Reference",
      "type": "Text",
      "required": true,
      "maxLength": 50,
      "description": "Auto-generated reference (Week 1-2026 format)"
    },
    {
      "internalName": "SelectionDate",
      "displayName": "Selection Date",
      "type": "DateTime",
      "required": true,
      "dateTimeFormat": "DateOnly",
      "description": "Date selection was generated"
    },
    {
      "internalName": "WeekNumber",
      "displayName": "Week Number",
      "type": "Number",
      "required": true,
      "minimum": 1,
      "maximum": 53,
      "description": "Week of year (1-53)"
    },
    {
      "internalName": "Year",
      "displayName": "Year",
      "type": "Number",
      "required": true,
      "minimum": 2020,
      "maximum": 2050,
      "description": "Calendar year"
    },
    {
      "internalName": "GeneratedBy",
      "displayName": "Generated By",
      "type": "User",
      "required": true,
      "description": "User who triggered generation"
    },
    {
      "internalName": "GeneratedDateTime",
      "displayName": "Generated Date/Time",
      "type": "DateTime",
      "required": true,
      "dateTimeFormat": "DateTime",
      "description": "Timestamp of generation"
    },
    {
      "internalName": "SelectionCount",
      "displayName": "Selection Count",
      "type": "Number",
      "required": true,
      "minimum": 1,
      "maximum": 20,
      "defaultValue": 10,
      "description": "Number of items selected (typically 10)"
    },
    {
      "internalName": "IsActive",
      "displayName": "Is Active",
      "type": "Boolean",
      "required": false,
      "defaultValue": true,
      "description": "Current/past selection flag"
    },
    {
      "internalName": "CompletedCount",
      "displayName": "Completed Count",
      "type": "Number",
      "required": false,
      "minimum": 0,
      "defaultValue": 0,
      "description": "Number of audits completed from this selection"
    },
    {
      "internalName": "CompletionPercentage",
      "displayName": "Completion %",
      "type": "Calculated",
      "formula": "=IF([SelectionCount]=0,0,ROUND([CompletedCount]/[SelectionCount]*100,0))",
      "outputType": "Number",
      "description": "Percentage of selected audits completed"
    }
  ],
  "views": [
    {
      "name": "All Selections",
      "viewType": "html",
      "isDefault": true,
      "viewFields": ["Title", "SelectionDate", "WeekNumber", "Year", "SelectionCount", "CompletedCount", "IsActive"],
      "sortField": "SelectionDate",
      "sortDirection": "Descending"
    },
    {
      "name": "Active Selections",
      "viewType": "html",
      "isDefault": false,
      "viewFields": ["Title", "SelectionDate", "SelectionCount", "CompletedCount", "CompletionPercentage"],
      "filter": "[IsActive] = 1",
      "sortField": "SelectionDate",
      "sortDirection": "Descending"
    },
    {
      "name": "By Year",
      "viewType": "html",
      "isDefault": false,
      "viewFields": ["Title", "WeekNumber", "SelectionDate", "SelectionCount", "CompletedCount"],
      "groupByField": "Year",
      "sortField": "WeekNumber",
      "sortDirection": "Ascending"
    },
    {
      "name": "Current Week",
      "viewType": "html",
      "isDefault": false,
      "viewFields": ["Title", "SelectionDate", "GeneratedBy", "SelectionCount", "CompletedCount", "CompletionPercentage"],
      "filter": "[IsActive] = 1",
      "sortField": "SelectionDate",
      "sortDirection": "Descending"
    }
  ],
  "validation": {
    "rules": [
      {
        "field": "WeekNumber",
        "formula": "=AND([WeekNumber]>=1,[WeekNumber]<=53)",
        "message": "Week number must be between 1 and 53"
      },
      {
        "field": "SelectionCount",
        "formula": "=AND([SelectionCount]>=1,[SelectionCount]<=20)",
        "message": "Selection count must be between 1 and 20"
      }
    ]
  }
}
